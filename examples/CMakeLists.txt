cmake_minimum_required(VERSION 3.8)

project(libsiedler2-examples)

set(RTTR_LIBSIEDLER2_DIR ${CMAKE_CURRENT_SOURCE_DIR}/..)

find_path(RTTR_LIBUTIL_DIR NAMES "include/libutil" HINTS ${RTTR_LIBSIEDLER2_DIR}/../libutil PATHS ENV LIBUTIL_DIR PATH_SUFFIXES ".." libutil)
if(NOT RTTR_LIBUTIL_DIR)
    message(FATAL_ERROR "Path to libutil not found! You can set the full path in the env var LIBUTIL_DIR ($ENV{LIBUTIL_DIR})")
endif()

find_path(RTTR_LIBENDIAN_DIR NAMES "include/libendian" HINTS ${RTTR_LIBSIEDLER2_DIR}/../libendian PATHS ENV LIBENDIAN_DIR PATH_SUFFIXES ".." libendian)
if(NOT RTTR_LIBENDIAN_DIR)
    message(FATAL_ERROR "Path to libendian not found! You can set the full path in the env var LIBENDIAN_DIR ($ENV{LIBENDIAN_DIR})")
endif()

list(APPEND CMAKE_MODULE_PATH "${RTTR_LIBUTIL_DIR}/cmake")

include(CheckCXXSourceCompiles)

# include Test
include(RttrTestingCfg)

# Require higher version as libsiedler2 because endian functions are not emulated here
include(RttrBoostCfg)

# Code coverage
include(RttrCoverageCfg)

# Use clang-format if available
find_package(ClangFormat 5.0.0)

add_subdirectory(${RTTR_LIBUTIL_DIR} libutil)
add_subdirectory(${RTTR_LIBENDIAN_DIR} libendian)
add_subdirectory(${RTTR_LIBSIEDLER2_DIR} libsiedler2)

set(RTTR_PAL5_PATH "${RTTR_LIBSIEDLER2_DIR}/examples/pal5.act")

add_subdirectory(chTransparentIdx)
add_subdirectory(lstpacker)
add_subdirectory(outline)

if(ClangFormat_FOUND)
    add_clangformat_target("file")
endif()
